<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>News Aggregator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
    };
  </script>
</head>
<body class="bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-100 transition duration-300">

  <!-- Header -->
  <header class="sticky top-0 z-50 bg-gradient-to-r from-blue-800 to-violet-500 dark:from-gray-800 dark:to-gray-700 text-white py-4 shadow-md">
    <div class="container mx-auto px-4 flex flex-wrap gap-4 justify-between items-center">
      
      <!-- Logo -->
      <h1 class="text-2xl font-bold">ğŸ“° News Aggregator</h1>

      <!-- Categories -->
      <nav class="flex flex-wrap gap-3 items-center">
        {% for cat in categories %}
          <a href="/?category={{ cat }}" class="hover:underline {% if selected == cat %}font-bold{% endif %} capitalize">
            {{ cat }}
          </a>
        {% endfor %}
      </nav>

      <!-- Search Bar -->
      <form action="/" method="get" class="flex gap-2">
        <input type="text" name="q" placeholder="Search..." value="{{ query or '' }}"
               class="px-2 py-1 rounded text-black" />
        <button type="submit" class="bg-white text-blue-600 px-3 py-1 rounded hover:bg-gray-100 text-xl">ğŸ”</button>
      </form>

      <!-- Dark Mode Toggle -->
      <button 
        onclick="toggleDarkMode()" 
        id="themeToggle" 
        class="text-2xl px-2 transition hover:font-bold hover:scale-110"
      >
        ğŸŒ
      </button>

    </div>
  </header>

  <!-- Main Content -->
  <main class="container mx-auto px-4 py-6">
    {% block content %}{% endblock %}
  </main>

  <!-- Footer -->
  <footer class="bg-blue-600 dark:bg-gray-800 text-white text-center py-3">
    &copy; {{ now.year }} News Aggregator
  </footer>

  <!-- Dark Mode Script -->
  <script>
    function toggleDarkMode() {
      const root = document.documentElement;
      const icon = document.getElementById("themeToggle");

      root.classList.toggle('dark');
      const isDark = root.classList.contains('dark');
      icon.textContent = isDark ? 'ğŸŒ™' : 'ğŸŒ';
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    }

    window.onload = () => {
      const root = document.documentElement;
      const icon = document.getElementById("themeToggle");
      if (localStorage.getItem('theme') === 'dark') {
        root.classList.add('dark');
        icon.textContent = 'ğŸŒ™';
      }
    };
  </script>

</body>
</html>
